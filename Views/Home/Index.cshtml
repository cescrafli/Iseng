@{
    ViewData["Title"] = "System Dashboard";
}

<div class="dashboard-header">
    <div class="container-fluid">
        <div class="row align-items-center">
            <div class="col">
                <h1>@ViewBag.MachineName <span class="status-badge">LIVE</span></h1>
                <p class="text-muted small mb-0">@ViewBag.OSVersion | Uptime: @ViewBag.Uptime</p>
            </div>
            <div class="col-auto">
                <span class="text-muted small">
                    <span id="systemStatusIndicator" class="status-indicator status-normal"></span>
                    Server Status: <span id="systemStatusText">Normal</span>
                </span>
            </div>
        </div>
    </div>
</div>

<div id="sentinelAlerts"></div>

<!-- Alert History Log -->
<div class="container-fluid mb-4">
    <div class="card p-3" style="max-height: 200px; overflow-y: auto;">
        <h6 class="text-muted text-uppercase fw-bold" style="font-size: 0.8rem;">Sentinel Alert Log</h6>
        <ul id="alertHistoryList" class="list-unstyled mb-0 small">
            <li class="text-muted fst-italic">No alerts recorded yet...</li>
        </ul>
    </div>
</div>

<div class="dashboard-grid">
    <!-- CPU Card -->
    <div class="card">
        <div class="card-title">
            CPU Utilization
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cpu" viewBox="0 0 16 16">
                <path d="M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14a2.5 2.5 0 0 1-2.5 2.5v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0zm-.5 3A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13h7a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 11.5 3h-7zM5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3zM6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
            </svg>
        </div>
        <div class="stat-value" id="cpuValue">--%</div>
        <div class="chart-container" style="position: relative; height: 150px; width: 100%;">
            <canvas id="cpuChart"></canvas>
        </div>
    </div>

    <!-- Memory Card -->
    <div class="card">
        <div class="card-title">
            Memory Usage
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-memory" viewBox="0 0 16 16">
                <path d="M1 3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h4.586a1 1 0 0 0 .707-.293l.353-.353a.5.5 0 0 1 .708 0l.353.353a1 1 0 0 0 .707.293H15a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H1zm.5 1h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5zm5 0h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5zm5 0h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5z"/>
            </svg>
        </div>
        <div class="stat-value" id="memValue">--%</div>
        <div class="chart-container" style="position: relative; height: 150px; width: 100%;">
            <canvas id="memChart"></canvas>
        </div>
    </div>

    <!-- Network Card -->
    <div class="card">
        <div class="card-title">
            Network I/O (In)
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-activity" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M6 2a.5.5 0 0 1 .47.33L10 12.036l1.53-4.208a.5.5 0 0 1 .94 0l6 3.257H16v1.5h-3.637a.5.5 0 0 1-.294-.09l-5.555-2.852l-1.996 5.49a.5.5 0 0 1-.94 0L6.47 2.33A.5.5 0 0 1 6 2z"/>
                <path fill-rule="evenodd" d="M3.5 10a.5.5 0 0 1 .5.5v.06a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5z"/>
            </svg>
        </div>
        <div class="stat-value" id="netInValue">-- KB/s</div>
        <div class="chart-container" style="position: relative; height: 150px; width: 100%;">
            <canvas id="netChart"></canvas>
        </div>
    </div>
</div>

<!-- Detailed Info Grid -->
<div class="dashboard-grid" style="margin-top: 30px; grid-template-columns: 2fr 1fr;">
    <!-- Processes Table -->
    <div class="card">
        <div class="card-title">
            Top Processes
            <span class="badge bg-secondary" style="font-size: 0.7em;">Top 20</span>
        </div>
        <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
            <table class="table table-hover table-sm" id="processTable">
                <thead>
                    <tr>
                        <th>PID</th>
                        <th>Name</th>
                        <th>User</th>
                        <th class="text-end">CPU</th>
                        <th class="text-end">Mem</th>
                        <th class="text-center" style="width: 80px;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="6" class="text-center text-muted">Waiting for data...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Disk Usage -->
    <div class="card">
        <div class="card-title">Disk Status</div>
        <div id="diskContainer" style="display: flex; flex-direction: column; gap: 20px;">
            <div class="text-center text-muted">Loading disks...</div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/monitor.js"></script>
}
